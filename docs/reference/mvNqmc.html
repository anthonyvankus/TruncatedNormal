<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Truncated multivariate normal cumulative distribution  (quasi-Monte Carlo) — mvNqmc • TruncatedNormal</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Truncated multivariate normal cumulative distribution  (quasi-Monte Carlo) — mvNqmc" />
<meta property="og:description" content="Computes an estimate and a deterministic upper bound of the probability Pr\((l&amp;lt;X&amp;lt;u)\),
where \(X\) is a zero-mean multivariate normal vector
with covariance matrix \(\Sigma\), that is, \(X\) is drawn from \(N(0,\Sigma)\).
Infinite values for vectors \(u\) and \(l\) are accepted.
The Monte Carlo method uses sample size \(n\): 
the larger \(n\), the smaller the relative error of the estimator." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TruncatedNormal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/TruncatedNormal_vignette.html">TruncatedNormal package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lbelzile/TruncatedNormal/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Truncated multivariate normal cumulative distribution  (quasi-Monte Carlo)</h1>
    <small class="dont-index">Source: <a href='https://github.com/lbelzile/TruncatedNormal/blob/master/R/mvNqmc.R'><code>R/mvNqmc.R</code></a></small>
    <div class="hidden name"><code>mvNqmc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes an estimate and a deterministic upper bound of the probability Pr\((l&lt;X&lt;u)\),
where \(X\) is a zero-mean multivariate normal vector
with covariance matrix \(\Sigma\), that is, \(X\) is drawn from \(N(0,\Sigma)\).
Infinite values for vectors \(u\) and \(l\) are accepted.
The Monte Carlo method uses sample size \(n\): 
the larger \(n\), the smaller the relative error of the estimator.</p>
    </div>

    <pre class="usage"><span class='fu'>mvNqmc</span>(<span class='no'>l</span>, <span class='no'>u</span>, <span class='no'>Sig</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>l</th>
      <td><p>lower truncation limit</p></td>
    </tr>
    <tr>
      <th>u</th>
      <td><p>upper truncation limit</p></td>
    </tr>
    <tr>
      <th>Sig</th>
      <td><p>covariance matrix of \(N(0,\Sigma)\)</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of Monte Carlo simulations</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with components</p><ul>
<li><p><code>prob</code>: estimated value of probability Pr\((l&lt;X&lt;u)\)</p></li>
<li><p><code>relErr</code>: estimated relative error of estimator</p></li>
<li><p><code>upbnd</code>:  theoretical upper bound on true Pr\((l&lt;X&lt;u)\)</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Suppose you wish to estimate Pr\((l&lt;AX&lt;u)\),
 where \(A\) is a full rank matrix
 and \(X\) is drawn from \(N(\mu,\Sigma)\), then you simply compute
 Pr\((l-A\mu&lt;AY&lt;u-A\mu)\),
 where \(Y\) is drawn from \(N(0, A\Sigma A^\top)\).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This version uses a Quasi Monte Carlo (QMC) pointset
of size <code><a href='https://rdrr.io/r/base/Round.html'>ceiling(n/12)</a></code> and estimates the relative error
using 12 independent randomized QMC estimators. QMC
is slower than ordinary Monte Carlo,
but is also likely to be more accurate when \(d&lt;50\).
For high dimensions, say \(d&gt;50\), you may obtain the same accuracy using
the (typically faster) <code><a href='mvNcdf.html'>mvNcdf</a></code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Z. I. Botev (2017), <em>The Normal Law Under Linear Restrictions:
Simulation and Estimation via Minimax Tilting</em>, Journal of the Royal
Statistical Society, Series B, <b>79</b> (1), pp. 1--24.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mvNcdf.html'>mvNcdf</a></code>, <code><a href='mvrandn.html'>mvrandn</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fl'>15</span>
<span class='no'>l</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='no'>d</span>
<span class='no'>u</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>Inf</span>, <span class='no'>d</span>)
<span class='no'>Sig</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>d</span>^<span class='fl'>2</span>), <span class='no'>d</span>, <span class='no'>d</span>)*<span class='fl'>2</span>
<span class='no'>Sig</span> <span class='kw'>&lt;-</span> <span class='no'>Sig</span> <span class='kw'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>Sig</span>)
<span class='fu'>mvNqmc</span>(<span class='no'>l</span>, <span class='no'>u</span>, <span class='no'>Sig</span>, <span class='fl'>1e4</span>) <span class='co'># compute the probability</span></div><div class='output co'>#&gt; $prob
#&gt; [1] 4.180292e-27
#&gt; 
#&gt; $relErr
#&gt; [1] 0.001089263
#&gt; 
#&gt; $upbnd
#&gt; [1] 7.8651e-27
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zdravko Botev, Leo Belzile.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


